


# PRS-Bridge-article-code

This repository contains instruction and scripts to reproduce all simulation and real data analyses from the PRS-Bridge article. It covers methods including PRS-Bridge, LDpred2, LASSOSUM, and PRS-CS, PRS-CS-Projection, PRS-CS-threshold, and PRS-CS-Regularized.


## Prerequisites
-   **External software:**  PRS-Bridge [https://github.com/YuzhengDun1999/PRSBridge](https://github.com/YuzhengDun1999/PRSBridge); PRS-CS [https://github.com/getian107/PRScs](https://github.com/getian107/PRScs); Plink 1.9 [https://www.cog-genomics.org/plink/](https://www.cog-genomics.org/plink/) and 2.0 [https://www.cog-genomics.org/plink/2.0/](https://www.cog-genomics.org/plink/2.0/); LDpred2 [https://privefl.github.io/bigsnpr/articles/LDpred2.html](https://privefl.github.io/bigsnpr/articles/LDpred2.html); LASSOSUM [https://github.com/tshmak/lassosum](https://github.com/tshmak/lassosum).
-   **Data:**  UK Biobank access for real trait analyses; simulated data and summary statistics for disease traits public available.

## Data Download
-   **Simulated data:**  
    Download from  [https://doi.org/10.7910/DVN/COXHAP](https://doi.org/10.7910/DVN/COXHAP).
-   **Real data:**
    -   Disease traits: check our manuscript and acc_form for reference and download link.
    -   Continuous traits: Individual-level genotype and phenotype data UK Biobank (application required). Follow the instruction in run-methods/process_continuous_dat.R to get summary statistics.
 
## Directory Structure and Usage

### data
This includes data to reproduce Figure 1 and example of input summary statistics for quality control and run all methods.
-   `PRScs_sumdat.txt`,  `chr22.bim`: For Figure 1.
-   `sumdat_Rcov.txt`: Example input summary statistics for quality control and generate summary statistics with format required by each method.

### PRS-CS-proj

Modified PRS-CS code; see  [https://github.com/getian107/PRScs](https://github.com/getian107/PRScs)  for original. This folder includes:

-   `PRScs_noconverge.py`: Modified PRS-CS without the ad hoc method. Example usage can be found in `plot-results/plot_fig1.R`.
- `PRScs_threshold.py`: different values of threshold chosen in ad hoc solution. Example usage can be found in scripts files generated by `run-methods/PRScs_threshold.R`.
-   `PRScs_proj.py`: Projected summary statistics. Example usage can be found in scripts files generated by `run-methods/PRScs_proj.R`.
-   `PRScs_Regularized.py`: Regularized LD. Example usage can be found in scripts files generated by `run-methods/PRScs_regularized.R`.

### run-simulation

Scripts for reproducing simulation analyses (Section 4.1):

1.  **Download simulated data**  (see above).
2.  **Preprocess summary statistics:**  `data_proc.R`
3.  **Run PRS methods:**  (Use scripts in  `run-methods`  with 1000G reference panels). For input parameters, please see further detail in `evaluation.R` for each method.
4.  **Evaluate results:**  `evaluation.R`
5.  **Visualize:**  `plot.R`  (produces Figure 3).

### run-methods

Scripts for running the methods on with given summary statistics in simulation and real data analysis:

**Step-by-step workflow:**

1.  **Preprocess GWAS summary statistics:**
	-   Simulated data: run  `run-simulation/data_proc.R`
    -   Disease traits: run  `process_disease_dat.R`
    -   Continuous traits (UK Biobank): run  `process_continuous_dat.R` to get summary statistics
3.  **Quality control:**  run  `sumdat_QC.R`
4.  **Run each PRS method:**  
    Use method-specific scripts (e.g.,  `PRScs.R`,  `PRSBridge.R`, etc.), ensuring the correct LD reference panel is specified (see each method's tutorial on how to estimate or download LD reference panel).

### evaluation
Scripts for evaluating methods:

-   `RE_Lassosum.R`: Computes relative efficiency for each method.
-   `get_sd_*.R`: Computes $R^2$ (or transformed AUC) and standard errors for each method:
    -   `get_sd_PRSBridge.R`
    -   `get_sd_PRScs.R`
    - ...

### plot-results

Scripts for visualization of results and reproducing figures:

-   `plot.R`: Generates results for Figures 4 and 5.
-   `plot_fig1.R`: Reproduces Figure 1 (posterior coefficients).
-   All plot scripts are annotated to specify which figure they reproduce and what input parameters to use in scripts in run-methods section.
